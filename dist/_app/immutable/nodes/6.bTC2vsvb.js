import{s as I,a as w,e as u,G as P,f as c,h as F,c as p,b as g,j as _,w as f,l as v,m as y,E as b,H as T,o as $,C,t as D,d as G}from"../chunks/scheduler.vwrL6P9E.js";import{e as k}from"../chunks/each.ug4NFR6d.js";import{S as H,i as J}from"../chunks/index.kO2rGTCX.js";import{g as h}from"../chunks/entry.ZZZaYNO6.js";import{a as L,F as S,t as M}from"../chunks/utils.IImh6JCv.js";import{s as O}from"../chunks/journey.NYZhiPzo.js";import{s as E}from"../chunks/messages.RVm4dX2E.js";function N(o,a,n){const s=o.slice();return s[3]=a[n],s[5]=n,s}function j(o){let a,n=o[5]+1+"",s,r;return{c(){a=u("span"),s=D(n),r=w(),this.h()},l(t){a=p(t,"SPAN",{class:!0});var e=g(a);s=G(e,n),r=F(e),e.forEach(c),this.h()},h(){_(a,"class","number svelte-sk2dn1"),f(a,"past",o[0]&&o[5]<o[1].films.length-1),f(a,"current",o[0]&&o[5]===o[1].films.length-1)},m(t,e){v(t,a,e),y(a,s),y(a,r)},p(t,e){e&3&&f(a,"past",t[0]&&t[5]<t[1].films.length-1),e&3&&f(a,"current",t[0]&&t[5]===t[1].films.length-1)},d(t){t&&c(a)}}}function V(o){let a,n,s;document.title=L("");let r=k({length:S}),t=[];for(let e=0;e<r.length;e+=1)t[e]=j(N(o,r,e));return{c(){a=w(),n=u("div"),s=u("div");for(let e=0;e<t.length;e+=1)t[e].c();this.h()},l(e){P("svelte-rk3sag",document.head).forEach(c),a=F(e),n=p(e,"DIV",{class:!0});var l=g(n);s=p(l,"DIV",{class:!0});var m=g(s);for(let d=0;d<t.length;d+=1)t[d].l(m);m.forEach(c),l.forEach(c),this.h()},h(){_(s,"class","numbers svelte-sk2dn1"),_(n,"class","page svelte-sk2dn1"),f(n,"mounted",o[0])},m(e,i){v(e,a,i),v(e,n,i),y(n,s);for(let l=0;l<t.length;l+=1)t[l]&&t[l].m(s,null)},p(e,[i]){if(i&3){r=k({length:S});let l;for(l=0;l<r.length;l+=1){const m=N(e,r,l);t[l]?t[l].p(m,i):(t[l]=j(m),t[l].c(),t[l].m(s,null))}for(;l<t.length;l+=1)t[l].d(1);t.length=r.length}i&1&&f(n,"mounted",e[0])},i:b,o:b,d(e){e&&(c(a),c(n)),T(t,e)}}}function q(o,a,n){let s;$(o,O,e=>n(1,s=e));let r=!1;async function t(){const{film:e}=await fetch("/.netlify/functions/random",{method:"POST",headers:{accept:"application/json"},body:JSON.stringify({genres:s.genres,people:s.people,avoid:[...s.avoid.map(i=>i.id),...s.films.map(i=>i.id)]})}).then(i=>i.json());n(0,r=!0),await M(1500),e.count===0?s.films.length===0?(E.add("No films in these categories - you've seen them all",{delay:2e3}),h("/filter",{replaceState:!0})):(E.add("No more films in these categories",{delay:2e3}),h("/results",{replaceState:!0})):h(`/film/${e.id}`,{replaceState:!0})}return C(()=>{if(!s.started){h("/");return}s.films.length>=S?h("/results"):t()}),[r,s]}class W extends H{constructor(a){super(),J(this,a,q,V,I,{})}}export{W as component};
